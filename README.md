# 🛰️ BBRF Server

A simple and secure API server built in Golang to manage **subdomains**, **scopes**, **IPs**, and **ASNs** for companies as part of a bug bounty recon platform. This backend powers clients like `bbrf-cli` to interact with stored reconnaissance data securely over TLS.

---

## 🚀 Features

- Add and query companies, domains, IPs, and ASNs
- Manage scope (in-scope, out-of-scope) items
- Authentication with JWT and `.env` secrets
- Secure HTTPS with autogenerated TLS certs
- Built with Go and PostgreSQL

---

## 🐳 Docker Setup

### 1. Clone the Repo

```bash
git clone https://github.com/yourusername/bbrf-server
cd bbrf-server
````

### 2. Setup `.env`

Create a `.env` file in the root of the project:

```ini
# .env
BBRF_USER=yourusername
BBRF_PASS=yourpassword
JWT_SECRET=yourjwttoken
POSTGRES_HOST=db
POSTGRES_PORT=5432
POSTGRES_DB=subdomains_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
```

### 3. Build Docker Containers

```bash
docker-compose up --build
```

This will:

* Start the API server at `https://localhost:8443`
* Spin up a PostgreSQL database
* Generate TLS certs (self-signed) if not already present

---


## 🔐 TLS Certificates

The server uses **self-signed TLS certificates** for HTTPS.

If you're running with Docker, the certificates are **automatically generated** on container startup and saved as:

- `cert.pem`
- `key.pem`

---

## 📦 API Overview

All API endpoints require **JWT Bearer token** authentication, except `/login`.

### Authentication

```http
POST /login
Body: { "username": "...", "password": "..." }
Response: { "token": "..." }
```

Add the token to all requests:

```
Authorization: Bearer <token>
```

---

## 🧠 System Overview (ASCII Diagram)

```text
                          ┌───────────────────────────────┐
                          │         BBRF Client           │
                          │      (CLI or Scripted)        │
                          └──────────────┬────────────────┘
                                         │ HTTPs + JWT
                                         ▼
                          ┌───────────────────────────────┐
                          │          API Server           │
                          │       (Go / Gorilla Mux)      │
                          └──────────────┬────────────────┘
                                         │ SQL (pgx/psql)
                                         ▼
                          ┌───────────────────────────────┐
                          │        PostgreSQL DB          │
                          │      (Docker Container)       │
                          └───────────────────────────────┘
```

---

## 🗃️ Database Layout (ASCII Schema)

```text
+----------------+
|   companies    |
+----------------+
| id (PK)        |
| name (unique)  |
+----------------+

+----------------+
|  subdomains    |
+----------------+
| id (PK)        |
| company_id     |
| subdomain      |
+----------------+

+----------------+
|  scope_domains |
+----------------+
| id (PK)        |
| company_id     |
| domain         |
| in_scope (bool)|
+----------------+

+----------------+
|     ips        |
+----------------+
| id (PK)        |
| company_id     |
| address        |
+----------------+

+----------------+
|     asns       |
+----------------+
| id (PK)        |
| company_id     |
| asn            |
+----------------+
```

---

## 🧪 Testing

Once the server is running, test with curl:

```bash
curl -k -X POST https://localhost:8443/login -d '{"username":"yourusername","password":"yourpassword"}' -H "Content-Type: application/json"
```

Use the returned JWT token for all future requests.

---

## 🔧 CLI Tool

Use the [BBRF Client](https://github.com/yourusername/bbrf-cli) for a terminal interface to the API.

---

## 👥 Contributors

* Hadi Asemi (@hadi-asemi)

---

## 📜 License

MIT License



