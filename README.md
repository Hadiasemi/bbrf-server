# ğŸ›°ï¸ BBRF Server

A simple and secure API server built in Golang to manage **subdomains**, **scopes**, **IPs**, and **ASNs** for companies as part of a bug bounty recon platform. This backend powers clients like `bbrf-cli` to interact with stored reconnaissance data securely over TLS.

---

## ğŸš€ Features

- Add and query companies, domains, IPs, and ASNs
- Manage scope (in-scope, out-of-scope) items
- Authentication with JWT and `.env` secrets
- Secure HTTPS with autogenerated TLS certs
- Built with Go and PostgreSQL

---

## ğŸ³ Docker Setup

### 1. Clone the Repo

```bash
git clone https://github.com/yourusername/bbrf-server
cd bbrf-server
````

### 2. Setup `.env`

Create a `.env` file in the root of the project:

```ini
# .env
BBRF_USER=yourusername
BBRF_PASS=yourpassword
JWT_SECRET=yourjwttoken
POSTGRES_HOST=db
POSTGRES_PORT=5432
POSTGRES_DB=subdomains_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
```

### 3. Build Docker Containers

```bash
docker-compose up --build
```

This will:

* Start the API server at `https://localhost:8443`
* Spin up a PostgreSQL database
* Generate TLS certs (self-signed) if not already present

---


## ğŸ” TLS Certificates

The server uses **self-signed TLS certificates** for HTTPS.

If you're running with Docker, the certificates are **automatically generated** on container startup and saved as:

- `cert.pem`
- `key.pem`

---

## ğŸ“¦ API Overview

All API endpoints require **JWT Bearer token** authentication, except `/login`.

### Authentication

```http
POST /login
Body: { "username": "...", "password": "..." }
Response: { "token": "..." }
```

Add the token to all requests:

```
Authorization: Bearer <token>
```

---

## ğŸ§  System Overview (ASCII Diagram)

```text
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚         BBRF Client           â”‚
                          â”‚      (CLI or Scripted)        â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚ HTTPs + JWT
                                         â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚          API Server           â”‚
                          â”‚       (Go / Gorilla Mux)      â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚ SQL (pgx/psql)
                                         â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚        PostgreSQL DB          â”‚
                          â”‚      (Docker Container)       â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ƒï¸ Database Layout (ASCII Schema)

```text
+----------------+
|   companies    |
+----------------+
| id (PK)        |
| name (unique)  |
+----------------+

+----------------+
|  subdomains    |
+----------------+
| id (PK)        |
| company_id     |
| subdomain      |
+----------------+

+----------------+
|  scope_domains |
+----------------+
| id (PK)        |
| company_id     |
| domain         |
| in_scope (bool)|
+----------------+

+----------------+
|     ips        |
+----------------+
| id (PK)        |
| company_id     |
| address        |
+----------------+

+----------------+
|     asns       |
+----------------+
| id (PK)        |
| company_id     |
| asn            |
+----------------+
```

---

## ğŸ§ª Testing

Once the server is running, test with curl:

```bash
curl -k -X POST https://localhost:8443/login -d '{"username":"yourusername","password":"yourpassword"}' -H "Content-Type: application/json"
```

Use the returned JWT token for all future requests.

---

## ğŸ”§ CLI Tool

Use the [BBRF Client](https://github.com/yourusername/bbrf-cli) for a terminal interface to the API.

---

## ğŸ‘¥ Contributors

* Hadi Asemi (@hadi-asemi)

---

## ğŸ“œ License

MIT License



